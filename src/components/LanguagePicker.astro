---
import { getLangFromUrl } from '../i18n/utils';
import { defaultLang, languages } from '../i18n/ui';

const currentLang = getLangFromUrl(Astro.url);
const pathParts = Astro.url.pathname.split('/').filter(Boolean);

const currentPath = languages[currentLang]
  ? pathParts.slice(1).join('/')
  : pathParts.join('/');

const langKeys = Object.keys(languages);
const activeIndex = langKeys.indexOf(currentLang);

const animationClass = activeIndex === 0 ? "slide-left" : "slide-right";
---
<style>
  .slide-left {
    animation: slideLeft 0.25s ease forwards;
  }
  .slide-right {
    animation: slideRight 0.25s ease forwards;
  }
  @keyframes slideLeft {
    from { transform: translateX(100%); }
    to   { transform: translateX(0%); }
  }
  @keyframes slideRight {
    from { transform: translateX(0%); }
    to   { transform: translateX(100%); }
  }
</style>

<div class="w-fit rounded-[5px] bg-[#ffffff1e] px-[0.15rem]">
  <div class="relative flex w-fit h-fit gap-2">

    {Object.entries(languages).map(([lang, label]) => {
      const href = lang === defaultLang
        ? `/${currentPath}`
        : `/${lang}/${currentPath}`;

      return (
        <a
          class="px-3 py-1 text-xl z-50 rounded-[5px] text-gray-700"
          href={href}
        >
          {lang.toUpperCase()}
        </a>
      );
    })}

    <div
      class={`absolute top-0 h-full w-[calc(100%/2)] border-transparent border-t-2 border-b-2 bg-clip-padding bg-green-500 rounded-[5px] ${animationClass}`}
    ></div>

  </div>
</div>
